# - - - - - - - - - - - - - - - #
events {
        worker_connections 20000; # Must be higher than your test concurrency
        multi_accept on;
}
# - - - - - - - - - - - - - - - #
upstream grafana {
	server 10.160.4.172:80;
	server 10.160.4.147:80;
	server 10.160.4.186:80;
}

map $http_upgrade $connection_upgrade {
  default upgrade;
  '' close;
}

server {
	listen 7193 backlog=40000;
	server_name test.yoop.jpo;
location / {
        proxy_redirect off;
        proxy_pass_request_body on;
        proxy_pass_request_headers on;
        proxy_set_header Host $host;
        proxy_set_header Y-Proxy-Server-Some Yaaaaaaaaaaaaaaa;
        proxy_set_header Y-Proxy-Server-From Aralez;
        proxy_set_header Y-Proxy-Server-Vers Aralezv98;
        proxy_buffer_size   128k;
        proxy_buffers   4 256k;
        proxy_busy_buffers_size   256k;
        proxy_pass http://grafana;
   }


}
server {
        listen 7194 ssl backlog=40000;
	server_name test.yoop.jpo;
        add_header Strict-Transport-Security "max-age=31536000" always;
        add_header X-Frame-Options "SAMEORIGIN";
        add_header X-XSS-Protection "1; mode=block";
        add_header X-Content-Type-Options nosniff;
	ssl_certificate /opt/aralez/etc/certs/test.crt;
	ssl_certificate_key /opt/aralez/etc/certs/test.key;

location / {
        proxy_redirect off;
        proxy_pass_request_body on;
        proxy_pass_request_headers on;
        proxy_set_header Host $host;
        proxy_set_header Y-Proxy-Server-Some Yaaaaaaaaaaaaaaa;
        proxy_set_header Y-Proxy-Server-From Aralez;
        proxy_set_header Y-Proxy-Server-Vers Aralezv98;
        proxy_buffer_size   128k;
        proxy_buffers   4 256k;
        proxy_busy_buffers_size   256k;
        proxy_pass http://grafana;
   }
}


server {
        listen 127.0.0.1:8088;
        root /var/www;
        index index.html ;
        server_name localhost;
	location /nginx_status {
	   stub_status on;
	}
}

server {
        listen 7193;
        server_name test.foo.bar;
location / {
        proxy_redirect off;
        proxy_pass_request_body on;
        proxy_pass_request_headers on;
        proxy_set_header Host $host;
        proxy_set_header Y-Proxy-Server-Some Yaaaaaaaaaaaaaaa;
        proxy_set_header Y-Proxy-Server-From Aralez;
        proxy_set_header Y-Proxy-Server-Vers Aralezv98;
        proxy_buffer_size   128k;
        proxy_buffers   4 256k;
        proxy_busy_buffers_size   256k;
        proxy_pass http://grafana;
   }


}
server {
        listen 7194 ssl;
        server_name test.foo.bar;
        add_header Strict-Transport-Security "max-age=31536000" always;
        add_header X-Frame-Options "SAMEORIGIN";
        add_header X-XSS-Protection "1; mode=block";
        add_header X-Content-Type-Options nosniff;
        ssl_certificate /opt/aralez/etc/certs/test.crt;
        ssl_certificate_key /opt/aralez/etc/certs/test.key;

location / {
        proxy_redirect off;
        proxy_pass_request_body on;
        proxy_pass_request_headers on;
        proxy_set_header Host $host;
        proxy_set_header Y-Proxy-Server-Some Yaaaaaaaaaaaaaaa;
        proxy_set_header Y-Proxy-Server-From Aralez;
        proxy_set_header Y-Proxy-Server-Vers Aralezv98;
        proxy_buffer_size   128k;
        proxy_buffers   4 256k;
        proxy_busy_buffers_size   256k;
        proxy_pass http://grafana;
   }
}


server {
        listen 7193; 
        server_name test.yoyo.bar;
location / {
        proxy_redirect off;
        proxy_pass_request_body on;
        proxy_pass_request_headers on;
        proxy_set_header Host $host;
        proxy_set_header Y-Proxy-Server-Some Yaaaaaaaaaaaaaaa;
        proxy_set_header Y-Proxy-Server-From Aralez;
        proxy_set_header Y-Proxy-Server-Vers Aralezv98;
        proxy_buffer_size   128k;
        proxy_buffers   4 256k;
        proxy_busy_buffers_size   256k;
        proxy_pass http://grafana;
   }


}
server {
        listen 7194 ssl;
        server_name test.yoyo.bar;
        add_header Strict-Transport-Security "max-age=31536000" always;
        add_header X-Frame-Options "SAMEORIGIN";
        add_header X-XSS-Protection "1; mode=block";
        add_header X-Content-Type-Options nosniff;
        ssl_certificate /opt/aralez/etc/certs/test.crt;
        ssl_certificate_key /opt/aralez/etc/certs/test.key;

location / {
        proxy_redirect off;
        proxy_pass_request_body on;
        proxy_pass_request_headers on;
        proxy_set_header Host $host;
        proxy_set_header Y-Proxy-Server-Some Yaaaaaaaaaaaaaaa;
        proxy_set_header Y-Proxy-Server-From Aralez;
        proxy_set_header Y-Proxy-Server-Vers Aralezv98;
        proxy_buffer_size   128k;
        proxy_buffers   4 256k;
        proxy_busy_buffers_size   256k;
        proxy_pass http://grafana;
   }
}

